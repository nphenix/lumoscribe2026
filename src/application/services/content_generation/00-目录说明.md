# content_generation 目录说明

> 内容生成模块的可配置工件（提示词与调用点种子）。
>
> 最后更新：2026-01-27

## 文件列表

| 文件 | 用途 | 更新日期 |
|---|---|---|
| `prompts.py` | 内容生成提示词种子 | 2026-01-18 |
| `callsites.py` | 内容生成调用点种子 | 2026-01-18 |
| `html_renderer.py` | 白皮书 HTML 渲染（纯渲染层，避免内容服务膨胀） | 2026-01-23 |
| `errors.py` | 内容生成错误定义（对外稳定导出） | 2026-01-27 |
| `types.py` | 内容生成类型定义（TemplateSection/Result 等） | 2026-01-27 |
| `text_utils.py` | 文本读取与模型输出清洗工具 | 2026-01-27 |
| `outline_utils.py` | 大纲解析与骨架生成 | 2026-01-27 |
| `chart_json_converter.py` | chart_json→ChartConfig 转换（兼容旧结构） | 2026-01-27 |
| `auto_chart_resolver.py` | 从 RAG 命中反查 chart_json 并抽取自动图表 | 2026-01-27 |
| `llm_section.py` | 章节 LLM 调用封装（支持 token 级流式） | 2026-01-27 |
| `service.py` | 内容生成主编排服务实现（拆分后的核心） | 2026-01-27 |

## 更新日志

| 日期 | 操作 | 文件 | 说明 |
|---|---|---|---|
| 2026-01-27 | 新增 | `service.py` | 拆分 `content_generation_service.py`：主编排下沉到模块目录 |
| 2026-01-27 | 新增 | `auto_chart_resolver.py` | 统一自动图表反查逻辑：支持 images 与 [图表] 摘要双路径 |
| 2026-01-27 | 新增 | `chart_json_converter.py` | 抽离 chart_json 转换逻辑，保留兼容与兜底 |
| 2026-01-27 | 新增 | `llm_section.py` | 抽离章节 LLM 调用，统一流式/非流式实现 |
| 2026-01-27 | 新增 | `outline_utils.py` | 抽离大纲解析与骨架构建 |
| 2026-01-27 | 新增 | `text_utils.py` | 抽离文本清洗与最佳努力读取 |
| 2026-01-27 | 新增 | `types.py` | 抽离类型定义，减少 service 文件体积 |
| 2026-01-27 | 新增 | `errors.py` | 抽离错误类型，稳定外部导入 |
| 2026-01-23 | 新增 | `html_renderer.py` | 抽离 HTML 渲染逻辑，降低 `content_generation_service.py` 体积与耦合 |
| 2026-01-18 | 修改 | `prompts.py` | 新增大纲润色提示词（SCOPE_OUTLINE_POLISH） |
| 2026-01-18 | 修改 | `callsites.py` | 新增大纲润色调用点（content_generation:polish_outline） |
| 2026-01-17 | 新增 | `prompts.py` | 新增章节内容生成提示词 |
| 2026-01-17 | 新增 | `callsites.py` | 新增章节内容生成调用点 |

